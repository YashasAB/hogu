<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BLR Map ‚Ä¢ Gen‚ÄëZ Neon Edition</title>

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="anonymous" />

  <style>
    :root{
      --bg:#0b0f19;            /* deep navy */
      --card:#0f172a;          /* slate-900 */
      --muted:#94a3b8;         /* slate-400 */
      --brand1:#7c3aed;        /* violet */
      --brand2:#06b6d4;        /* cyan */
      --brand3:#22c55e;        /* green */
      --accent:#f43f5e;        /* rose */
      --ring: 0 0 0 8px rgba(124,58,237,.18), 0 0 60px rgba(6,182,212,.18);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{font-family: ui-sans-serif,system-ui,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif;background:linear-gradient(180deg,var(--bg),#050810 85%);color:#e5e7eb}
    .wrap{max-width:1100px;margin:28px auto;padding:0 16px}

    /* Header card */
    .card{background:rgba(15,23,42,.8);border:1px solid rgba(148,163,184,.12);border-radius:24px;box-shadow:0 10px 40px rgba(0,0,0,.35);backdrop-filter: blur(8px);overflow:hidden}
    .card-header{position:relative;padding:18px 20px 16px;background: radial-gradient(1200px 1200px at -10% -10%, rgba(124,58,237,.28), transparent 50%), radial-gradient(1200px 1200px at 110% -10%, rgba(6,182,212,.22), transparent 50%);}
    .title{display:flex;align-items:center;gap:12px;margin:0 0 4px 0;font-weight:800;letter-spacing:.2px}
    .title .dot{width:10px;height:10px;border-radius:999px;background:linear-gradient(135deg,var(--brand1),var(--brand2));box-shadow:0 0 0 6px rgba(124,58,237,.2)}
    .subtitle{margin:0;color:var(--muted);font-size:13px}

    /* Top controls */
    .toolbar{display:flex;flex-wrap:wrap;gap:10px;margin:12px 16px 0 16px}
    .chip{user-select:none;cursor:pointer;padding:8px 12px;border-radius:999px;border:1px solid rgba(148,163,184,.18);color:#cbd5e1;background:rgba(30,41,59,.6);font-size:13px;display:inline-flex;align-items:center;gap:8px;transition:.2s}
    .chip:hover{transform:translateY(-1px);box-shadow:var(--ring)}
    .chip.active{background:linear-gradient(135deg, rgba(124,58,237,.25), rgba(6,182,212,.25));border-color:transparent}

    .map-shell{padding:16px}
    #map{height:72vh;width:100%;border-radius:18px;border:1px solid rgba(148,163,184,.12);box-shadow:0 20px 60px rgba(124,58,237,.08), 0 10px 30px rgba(6,182,212,.08);overflow:hidden}

    .legend{font-size:12px;opacity:.85;margin:10px 2px;color:var(--muted)}
    .legend a{color:#a78bfa}

    /* Fancy emoji marker */
    .pin{position:relative;display:grid;place-items:center;width:38px;height:38px;border-radius:12px;background:rgba(17,24,39,.85);border:1px solid rgba(148,163,184,.22);box-shadow:0 10px 24px rgba(124,58,237,.25);}
    .pin--hot{box-shadow:0 0 0 6px rgba(244,63,94,.15), 0 20px 40px rgba(244,63,94,.2)}
    .pin__emoji{font-size:20px;filter:drop-shadow(0 2px 6px rgba(0,0,0,.35))}
    .pulse{position:absolute;inset:-10px;border-radius:16px;border:2px solid rgba(124,58,237,.35);animation:pulse 2.2s ease-out infinite}
    @keyframes pulse{0%{transform:scale(.65);opacity:.8}70%{transform:scale(1.15);opacity:.15}100%{transform:scale(1.3);opacity:0}}

    /* Floating buttons */
    .fab{position:absolute;right:18px;bottom:18px;display:flex;flex-direction:column;gap:10px;z-index:500}
    .btn{cursor:pointer;border:none;padding:10px 12px;border-radius:12px;background:linear-gradient(135deg,var(--brand2),var(--brand1));color:white;font-weight:600;box-shadow:0 10px 30px rgba(6,182,212,.25);}
    .btn.secondary{background:rgba(30,41,59,.8);color:#e5e7eb;border:1px solid rgba(148,163,184,.18)}

    /* Leaflet default tweaks */
    .leaflet-control-attribution{background:rgba(15,23,42,.7)!important;color:#cbd5e1!important;border-radius:12px;padding:2px 8px!important}
    .leaflet-control a{color:#a78bfa!important}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="card-header">
        <h1 class="title"><span class="dot"></span> Bengaluru Map <span style="opacity:.6;font-weight:600">‚Ä¢ Neon</span></h1>
        <p class="subtitle">Open‚Äësource tiles, cute emoji pins, live location & quick filters. Scroll to zoom, drag to pan.</p>
        <div class="toolbar" id="toolbar">
          <div class="chip active" data-filter="all">‚ú® All</div>
          <div class="chip" data-filter="spicy">üå∂Ô∏è Spicy</div>
          <div class="chip" data-filter="veg">ü•ó Veg</div>
          <div class="chip" data-filter="coffee">‚òï Coffee</div>
          <div class="chip" data-filter="dessert">üçÆ Dessert</div>
        </div>
      </div>
      <div class="map-shell">
        <div id="map"></div>
        <div class="legend">Tiles ¬© <a href="https://www.openstreetmap.org/copyright" target="_blank" rel="noreferrer noopener">OpenStreetMap</a> contributors ‚Ä¢ Dark tiles ¬© <a href="https://carto.com/" target="_blank" rel="noreferrer noopener">CARTO</a> ‚Ä¢ Built with <a href="https://leafletjs.com/" target="_blank" rel="noreferrer noopener">Leaflet</a></div>
      </div>
    </div>
  </div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin="anonymous"></script>

  <script>
    // --- Base setup
    const BLR = [12.9716, 77.5946];
    const map = L.map('map', { center: BLR, zoom: 12, scrollWheelZoom: true, zoomControl: true });

    // Base layers
    const osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; OpenStreetMap contributors'
    });

    // A stylish dark basemap (CARTO Dark Matter)
    const dark = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
      maxZoom: 20,
      attribution: '&copy; OpenStreetMap contributors &copy; CARTO'
    });

    dark.addTo(map);

    // Layer switcher
    L.control.layers({ 'üó∫Ô∏è OSM': osm, 'üåë Dark': dark }, {}).addTo(map);

    // --- Fancy emoji markers
    function emojiMarker([lat, lng], emoji='üçΩÔ∏è', hot=false){
      const html = `<div class="pin ${hot? 'pin--hot':''}"><span class="pulse"></span><span class="pin__emoji">${emoji}</span></div>`;
      const icon = L.divIcon({ className:'', html, iconSize:[38,38], iconAnchor:[19,19], popupAnchor:[0,-14] });
      return L.marker([lat, lng], { icon });
    }

    // Sample data (swap with your list)
    const PLACES = [
      { name:'Nandini Veg Indiranagar', cat:'veg', emoji:'ü•ó', hot:true,  lat:12.9719, lng:77.6412, desc:'All‚Äëveg vibes near Indiranagar.' },
      { name:'Spice Hub Koramangala',  cat:'spicy', emoji:'üå∂Ô∏è', hot:true,  lat:12.9279, lng:77.6271, desc:'Bring water. You\'ll need it.' },
      { name:'Third Wave MG Road',      cat:'coffee', emoji:'‚òï', hot:false, lat:12.9736, lng:77.6200, desc:'Solid brews near MG Road.' },
      { name:'Church St Dessert Co',    cat:'dessert', emoji:'üçÆ', hot:false, lat:12.9752, lng:77.6058, desc:'Sugar therapy on Church Street.' },
      { name:'Hot Mess Indira',         cat:'spicy', emoji:'üî•', hot:true,  lat:12.9690, lng:77.6400, desc:'Fiery plates, cozy nook.' }
    ];

    // Group markers by category
    const groups = {
      all: L.layerGroup().addTo(map),
      spicy: L.layerGroup(),
      veg: L.layerGroup(),
      coffee: L.layerGroup(),
      dessert: L.layerGroup()
    };

    const latlngs = [];
    PLACES.forEach(p => {
      const m = emojiMarker([p.lat, p.lng], p.emoji, p.hot).addTo(groups[p.cat]);
      m.bindPopup(`<b>${p.name}</b><br/>${p.desc}`);
      latlngs.push([p.lat, p.lng]);
      // also add to the "all" group
      emojiMarker([p.lat, p.lng], p.emoji, p.hot).addTo(groups.all).bindPopup(`<b>${p.name}</b><br/>${p.desc}`);
    });

    // Fit bounds to markers
    if(latlngs.length){ map.fitBounds(latlngs, { padding:[28,28] }); }

    // --- Filter chips logic
    const toolbar = document.getElementById('toolbar');
    function setFilter(key){
      // toggle UI
      Array.from(toolbar.children).forEach(ch => ch.classList.toggle('active', ch.dataset.filter === key));
      // clear all groups
      Object.values(groups).forEach(g => map.removeLayer(g));
      // add selected
      (key === 'all' ? groups.all : groups[key]).addTo(map);
    }

    toolbar.addEventListener('click', (e)=>{
      const chip = e.target.closest('.chip');
      if(!chip) return;
      setFilter(chip.dataset.filter);
    });

    // --- Geolocate (nice for mobile)
    const fab = document.createElement('div');
    fab.className = 'fab';
    fab.innerHTML = `
      <button class="btn" id="locate">üìç My location</button>
      <button class="btn secondary" id="share">üîó Copy view link</button>
    `;
    document.querySelector('.map-shell').appendChild(fab);

    document.getElementById('locate').onclick = () => {
      if(!navigator.geolocation){ alert('Geolocation not supported'); return; }
      navigator.geolocation.getCurrentPosition(pos => {
        const { latitude:lat, longitude:lng } = pos.coords;
        const marker = emojiMarker([lat,lng], 'üß≠');
        marker.addTo(map).bindPopup('<b>You are here</b>').openPopup();
        map.flyTo([lat,lng], 15, { duration: 0.8 });
      }, err => alert('Location blocked'));
    };

    // --- Shareable view
    function updateHash(){
      const c = map.getCenter();
      const z = map.getZoom();
      const hash = `#${c.lat.toFixed(5)},${c.lng.toFixed(5)},z${z}`;
      history.replaceState(null,'',hash);
    }
    map.on('moveend', updateHash);
    document.getElementById('share').onclick = async () => {
      updateHash();
      try { await navigator.clipboard.writeText(location.href); alert('Link copied!'); } catch(e){ alert('Link: '+location.href); }
    };

    // Restore from hash if present
    if(location.hash){
      const m = location.hash.match(/#(-?\d+\.\d+),(-?\d+\.\d+),z(\d+)/);
      if(m){ map.setView([parseFloat(m[1]), parseFloat(m[2])], parseInt(m[3],10)); }
    }
  </script>
</body>
</html>
